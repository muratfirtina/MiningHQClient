<div class="modern-machine-files-page">
  
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">
          <i class="fas fa-folder-open"></i>
          Makina Dosyaları
        </h1>
        <p class="page-subtitle" *ngIf="machine">
          {{ machine.name }} - {{ machine.brandName }} {{ machine.modelName }}
        </p>
      </div>
      <div class="header-actions">
        <button class="header-btn primary" (click)="addMachineFiles()">
          <i class="fas fa-plus"></i>
          Dosya Ekle
        </button>
        <button class="header-btn secondary" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
          Geri Dön
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="container-custom">
      
      <!-- Machine Info Card -->
      <div class="machine-info-card" *ngIf="machine">
        <div class="machine-summary">
          <div class="machine-avatar">
            <i class="fas fa-cogs"></i>
          </div>
          <div class="machine-details">
            <h3>{{ machine.name }}</h3>
            <div class="machine-meta">
              <span class="meta-item">
                <i class="fas fa-tag"></i>
                {{ machine.brandName }}
              </span>
              <span class="meta-item">
                <i class="fas fa-cube"></i>
                {{ machine.modelName }}
              </span>
              <span class="meta-item">
                <i class="fas fa-wrench"></i>
                {{ machine.machineTypeName }}
              </span>
              <span class="meta-item">
                <i class="fas fa-map-marker-alt"></i>
                {{ machine.quarryName }}
              </span>
            </div>
          </div>
        </div>
        <div class="file-stats">
          <div class="stat-item">
            <span class="stat-number">{{ machineFiles.length }}</span>
            <span class="stat-label">Dosya</span>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-section">
        <div class="loading-spinner">
          <i class="fas fa-spinner fa-spin"></i>
        </div>
        <p>Dosyalar yükleniyor...</p>
      </div>

      <!-- Files Section -->
      <div class="files-section" *ngIf="!isLoading">
        
        <!-- Files Actions -->
        <div class="files-actions">
          <div class="actions-left">
            <h3>Makina Dosyaları</h3>
            <span class="files-count">{{ machineFiles.length }} dosya</span>
          </div>
          <div class="actions-right">
            <button class="action-btn primary" (click)="addMachineFiles()">
              <i class="fas fa-plus"></i>
              Dosya Ekle
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="machineFiles.length === 0" class="empty-state">
          <div class="empty-icon">
            <i class="fas fa-folder-open"></i>
          </div>
          <h3>Henüz dosya yüklenmemiş</h3>
          <p>Bu makina için henüz dosya bulunmuyor. İlk dosyayı yüklemek için "Dosya Ekle" butonunu kullanın.</p>
          <button class="empty-action-btn" (click)="addMachineFiles()">
            <i class="fas fa-plus"></i>
            İlk Dosyayı Ekle
          </button>
        </div>

        <!-- Files Grid -->
        <div class="files-grid" *ngIf="machineFiles.length > 0">
          <div 
            class="file-card" 
            *ngFor="let file of machineFiles; trackBy: trackByFileId"
            [class.image-file]="isImageFile(file.fileName)">
            
            <!-- Image Preview -->
            <div class="file-preview" *ngIf="isImageFile(file.fileName)">
              <img [src]="file.safeUrl" [alt]="file.fileName" />
              <div class="preview-overlay">
                <button class="preview-btn" (click)="openFilePreview(file)">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>

            <!-- Non-Image File Icon -->
            <div class="file-icon" *ngIf="!isImageFile(file.fileName)">
              <i [class]="getFileIcon(file.fileName)"></i>
            </div>

            <!-- File Info -->
            <div class="file-info">
              <h4 class="file-name" [title]="file.fileName">{{ file.fileName }}</h4>
              <div class="file-meta">
                <span class="file-size">{{ getFileSize(file.size || 0) }}</span>
                <span class="file-date" *ngIf="file.uploadDate">{{ formatDate(file.uploadDate) }}</span>
              </div>
            </div>

            <!-- File Actions -->
            <div class="file-actions">
              <button class="file-action-btn download" (click)="downloadFile(file)" title="İndir">
                <i class="fas fa-download"></i>
              </button>
              <button class="file-action-btn view" (click)="openFilePreview(file)" title="Görüntüle">
                <i class="fas fa-eye"></i>
              </button>
              <button class="file-action-btn delete" (click)="confirmDeleteFile(file)" title="Sil">
                <i class="fas fa-trash"></i>
              </button>
            </div>

          </div>
        </div>
      </div>

    </div>
  </div>

</div>
